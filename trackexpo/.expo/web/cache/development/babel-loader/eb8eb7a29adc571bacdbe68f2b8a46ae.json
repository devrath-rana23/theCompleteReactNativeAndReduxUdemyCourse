{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { useState, useEffect } from \"react\";\nimport { Accuracy, requestForegroundPermissionsAsync, watchPositionAsync } from \"expo-location\";\nexport default (function (shouldTrack, callback) {\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      err = _useState2[0],\n      setErr = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      subscriber = _useState4[0],\n      setSubscriber = _useState4[1];\n\n  var startWatching = function _callee() {\n    var _await$requestForegro, granted, sub;\n\n    return _regeneratorRuntime.async(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(requestForegroundPermissionsAsync());\n\n          case 3:\n            _await$requestForegro = _context.sent;\n            granted = _await$requestForegro.granted;\n\n            if (granted) {\n              _context.next = 7;\n              break;\n            }\n\n            throw new Error(\"Location permission not granted\");\n\n          case 7:\n            _context.next = 9;\n            return _regeneratorRuntime.awrap(watchPositionAsync({\n              accuracy: Accuracy.BestForNavigation,\n              timeInterval: 1000,\n              distanceInterval: 10\n            }, callback));\n\n          case 9:\n            sub = _context.sent;\n            setSubscriber(sub);\n            _context.next = 16;\n            break;\n\n          case 13:\n            _context.prev = 13;\n            _context.t0 = _context[\"catch\"](0);\n            setErr(_context.t0);\n\n          case 16:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[0, 13]], Promise);\n  };\n\n  useEffect(function () {\n    if (shouldTrack) {\n      startWatching();\n    } else {\n      subscriber.remove();\n      setSubscriber(null);\n    }\n  }, [shouldTrack]);\n  return [err];\n});","map":{"version":3,"names":["useState","useEffect","Accuracy","requestForegroundPermissionsAsync","watchPositionAsync","shouldTrack","callback","err","setErr","subscriber","setSubscriber","startWatching","granted","Error","accuracy","BestForNavigation","timeInterval","distanceInterval","sub","remove"],"sources":["/var/www/html/theCompleteReactNativeAndReduxUdemyCourse/trackexpo/src/hooks/useLocation.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport {\n  Accuracy,\n  requestForegroundPermissionsAsync,\n  watchPositionAsync,\n} from \"expo-location\";\n\nexport default (shouldTrack, callback) => {\n  const [err, setErr] = useState(null);\n  const [subscriber, setSubscriber] = useState(null);\n\n  const startWatching = async () => {\n    try {\n      const { granted } = await requestForegroundPermissionsAsync();\n      if (!granted) {\n        throw new Error(\"Location permission not granted\");\n      }\n      const sub = await watchPositionAsync(\n        {\n          accuracy: Accuracy.BestForNavigation,\n          timeInterval: 1000,\n          distanceInterval: 10,\n        },\n        callback\n      );\n      setSubscriber(sub);\n    } catch (e) {\n      setErr(e);\n    }\n  };\n\n  useEffect(() => {\n    if (shouldTrack) {\n      startWatching();\n    } else {\n      subscriber.remove();\n      setSubscriber(null);\n    }\n  }, [shouldTrack]);\n\n  return [err]; //returning array is convention of hooks\n};\n"],"mappings":";;AAAA,SAASA,QAAT,EAAmBC,SAAnB,QAAoC,OAApC;AACA,SACEC,QADF,EAEEC,iCAFF,EAGEC,kBAHF,QAIO,eAJP;AAMA,gBAAe,UAACC,WAAD,EAAcC,QAAd,EAA2B;EACxC,gBAAsBN,QAAQ,CAAC,IAAD,CAA9B;EAAA;EAAA,IAAOO,GAAP;EAAA,IAAYC,MAAZ;;EACA,iBAAoCR,QAAQ,CAAC,IAAD,CAA5C;EAAA;EAAA,IAAOS,UAAP;EAAA,IAAmBC,aAAnB;;EAEA,IAAMC,aAAa,GAAG;IAAA;;IAAA;MAAA;QAAA;UAAA;YAAA;YAAA;YAAA,iCAEQR,iCAAiC,EAFzC;;UAAA;YAAA;YAEVS,OAFU,yBAEVA,OAFU;;YAAA,IAGbA,OAHa;cAAA;cAAA;YAAA;;YAAA,MAIV,IAAIC,KAAJ,CAAU,iCAAV,CAJU;;UAAA;YAAA;YAAA,iCAMAT,kBAAkB,CAClC;cACEU,QAAQ,EAAEZ,QAAQ,CAACa,iBADrB;cAEEC,YAAY,EAAE,IAFhB;cAGEC,gBAAgB,EAAE;YAHpB,CADkC,EAMlCX,QANkC,CANlB;;UAAA;YAMZY,GANY;YAclBR,aAAa,CAACQ,GAAD,CAAb;YAdkB;YAAA;;UAAA;YAAA;YAAA;YAgBlBV,MAAM,aAAN;;UAhBkB;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAtB;;EAoBAP,SAAS,CAAC,YAAM;IACd,IAAII,WAAJ,EAAiB;MACfM,aAAa;IACd,CAFD,MAEO;MACLF,UAAU,CAACU,MAAX;MACAT,aAAa,CAAC,IAAD,CAAb;IACD;EACF,CAPQ,EAON,CAACL,WAAD,CAPM,CAAT;EASA,OAAO,CAACE,GAAD,CAAP;AACD,CAlCD"},"metadata":{},"sourceType":"module"}