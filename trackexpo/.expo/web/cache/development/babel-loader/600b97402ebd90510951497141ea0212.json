{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport createDataContext from \"./createDataContext\";\nimport React from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport trackerApi from \"../api/tracker\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { navigate } from \"../navigationRef\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nvar authReducer = function authReducer(state, action) {\n  switch (action.type) {\n    case \"add_error\":\n      return _objectSpread(_objectSpread({}, state), {}, {\n        errorMessage: action.payload\n      });\n\n    case \"signin\":\n      return {\n        errorMessage: \"\",\n        token: action.payload\n      };\n\n    case \"signout\":\n      return {\n        token: null,\n        errorMessage: \"\"\n      };\n\n    case \"clear_error_message\":\n      return _objectSpread(_objectSpread({}, state), {}, {\n        errorMessage: \"\"\n      });\n\n    default:\n      return state;\n  }\n};\n\nvar tryLocalSignin = function tryLocalSignin(dispatch) {\n  return function _callee() {\n    var token;\n    return _regeneratorRuntime.async(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"token\"));\n\n          case 2:\n            token = _context.sent;\n\n            if (token) {\n              dispatch({\n                type: \"signin\",\n                payload: token\n              });\n              navigate(\"TrackList\");\n            } else {\n              navigate(\"Signup\");\n            }\n\n          case 4:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n};\n\nvar clearErrorMessage = function clearErrorMessage(dispatch) {\n  return function () {\n    dispatch({\n      type: \"clear_error_message\"\n    });\n  };\n};\n\nvar signup = function signup(dispatch) {\n  return function _callee2(_ref) {\n    var email, password, response;\n    return _regeneratorRuntime.async(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            email = _ref.email, password = _ref.password;\n            _context2.prev = 1;\n            console.log(\"re\");\n            _context2.next = 5;\n            return _regeneratorRuntime.awrap(trackerApi.post(\"/signup\", {\n              email: email,\n              password: password\n            }));\n\n          case 5:\n            response = _context2.sent;\n            console.log(\"response\");\n            console.log(response);\n            _context2.next = 10;\n            return _regeneratorRuntime.awrap(AsyncStorage.setItem(\"token\", response.data.token));\n\n          case 10:\n            dispatch({\n              type: \"signin\",\n              payload: response.data.token\n            });\n            navigate(\"TrackList\");\n            _context2.next = 18;\n            break;\n\n          case 14:\n            _context2.prev = 14;\n            _context2.t0 = _context2[\"catch\"](1);\n            console.log(_context2.t0);\n            dispatch({\n              type: \"add_error\",\n              payload: \"Something went wrong with sign up\"\n            });\n\n          case 18:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[1, 14]], Promise);\n  };\n};\n\nvar signin = function signin(dispatch) {\n  return function _callee3(_ref2) {\n    var email, password, response;\n    return _regeneratorRuntime.async(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            email = _ref2.email, password = _ref2.password;\n            _context3.prev = 1;\n            _context3.next = 4;\n            return _regeneratorRuntime.awrap(trackerApi.post(\"/signin\", {\n              email: email,\n              password: password\n            }));\n\n          case 4:\n            response = _context3.sent;\n            _context3.next = 7;\n            return _regeneratorRuntime.awrap(AsyncStorage.setItem(\"token\", response.data.token));\n\n          case 7:\n            dispatch({\n              type: \"signin\",\n              payload: response.data.token\n            });\n            navigate(\"TrackList\");\n            _context3.next = 14;\n            break;\n\n          case 11:\n            _context3.prev = 11;\n            _context3.t0 = _context3[\"catch\"](1);\n            dispatch({\n              type: \"add_error\",\n              payload: \"Something went wrong with sign in\"\n            });\n\n          case 14:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, [[1, 11]], Promise);\n  };\n};\n\nvar signout = function signout(dispatch) {\n  return function _callee4() {\n    return _regeneratorRuntime.async(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.next = 2;\n            return _regeneratorRuntime.awrap(AsyncStorage.removeItem(\"token\"));\n\n          case 2:\n            dispatch({\n              type: \"signout\"\n            });\n            navigate(\"loginFlow\");\n\n          case 4:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n};\n\nvar _createDataContext = createDataContext(authReducer, {\n  signin: signin,\n  signout: signout,\n  signup: signup,\n  clearErrorMessage: clearErrorMessage,\n  tryLocalSignin: tryLocalSignin\n}, {\n  token: null,\n  errorMessage: \"\"\n}),\n    Provider = _createDataContext.Provider,\n    Context = _createDataContext.Context;\n\nexport { Provider, Context };\n\nvar AuthContext = function AuthContext() {\n  return _jsx(View, {\n    children: _jsx(Text, {})\n  });\n};\n\nexport default AuthContext;","map":{"version":3,"names":["createDataContext","React","trackerApi","AsyncStorage","navigate","authReducer","state","action","type","errorMessage","payload","token","tryLocalSignin","dispatch","getItem","clearErrorMessage","signup","email","password","console","log","post","response","setItem","data","signin","signout","removeItem","Provider","Context","AuthContext"],"sources":["/var/www/html/theCompleteReactNativeAndReduxUdemyCourse/trackexpo/src/context/AuthContext.js"],"sourcesContent":["import createDataContext from \"./createDataContext\";\nimport React from \"react\";\nimport { View, Text } from \"react-native\";\nimport trackerApi from \"../api/tracker\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { navigate } from \"../navigationRef\";\n\nconst authReducer = (state, action) => {\n  switch (action.type) {\n    case \"add_error\":\n      return { ...state, errorMessage: action.payload };\n    case \"signin\":\n      return { errorMessage: \"\", token: action.payload };\n    case \"signout\":\n      return { token: null, errorMessage: \"\" };\n    case \"clear_error_message\":\n      return { ...state, errorMessage: \"\" };\n    default:\n      return state;\n  }\n};\n\nconst tryLocalSignin = (dispatch) => async () => {\n  const token = await AsyncStorage.getItem(\"token\");\n  if (token) {\n    dispatch({ type: \"signin\", payload: token });\n    navigate(\"TrackList\");\n  } else {\n    navigate(\"Signup\");\n  }\n};\n\nconst clearErrorMessage = (dispatch) => () => {\n  dispatch({ type: \"clear_error_message\" });\n};\n\nconst signup =\n  (dispatch) =>\n  async ({ email, password }) => {\n    try {\n      console.log(\"re\");\n      const response = await trackerApi.post(\"/signup\", { email, password });\n      console.log(\"response\");\n      console.log(response);\n      await AsyncStorage.setItem(\"token\", response.data.token);\n      dispatch({\n        type: \"signin\",\n        payload: response.data.token,\n      });\n\n      navigate(\"TrackList\");\n    } catch (err) {\n      console.log(err)\n      dispatch({\n        type: \"add_error\",\n        payload: \"Something went wrong with sign up\",\n      });\n    }\n  };\n\nconst signin =\n  (dispatch) =>\n  async ({ email, password }) => {\n    try {\n      const response = await trackerApi.post(\"/signin\", { email, password });\n      await AsyncStorage.setItem(\"token\", response.data.token);\n      dispatch({\n        type: \"signin\",\n        payload: response.data.token,\n      });\n\n      navigate(\"TrackList\");\n    } catch (err) {\n      dispatch({\n        type: \"add_error\",\n        payload: \"Something went wrong with sign in\",\n      });\n    }\n  };\n\nconst signout = (dispatch) => async () => {\n  await AsyncStorage.removeItem(\"token\");\n  dispatch({ type: \"signout\" });\n  navigate(\"loginFlow\");\n};\n\nexport const { Provider, Context } = createDataContext(\n  authReducer,\n  { signin, signout, signup, clearErrorMessage, tryLocalSignin },\n  { token: null, errorMessage: \"\" }\n);\n\nconst AuthContext = () => {\n  return (\n    <View>\n      <Text></Text>\n    </View>\n  );\n};\n\nexport default AuthContext;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}